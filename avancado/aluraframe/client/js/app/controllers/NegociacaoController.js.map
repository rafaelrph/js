{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_campoData","_campoQuantidade","_campoValor","_ordemAtual","_service","NegociacaoService","_listaNegociacoes","Binding","ListaNegociacoes","NegociacaoView","_mensagem","Mensagem","MensagemView","_init","setInterval","importarTodasNegociacoes","event","preventDefault","negociacao","_criarNegociacao","adicionar","then","texto","_limparFormulario","catch","error","listar","negociacoes","forEach","removerTodos","esvaziar","data","DateHelper","textoParaData","value","Negociacao","focus","importar","obterNegociacoesDaSemana","obterNegociacoesAnterior","erro","obterNegociacoesRetrasada","coluna","inverter","ordenar","a","b"],"mappings":";;;;;;IAAMA,oB;AAEL,iCAAc;AAAA;;AACb,MAAIC,IAAIC,SAASC,aAAT,CAAuBC,IAAvB,CAA4BF,QAA5B,CAAR;AACA,OAAKG,UAAL,GAAkBJ,EAAE,OAAF,CAAlB;AACA,OAAKK,gBAAL,GAAwBL,EAAE,aAAF,CAAxB;AACA,OAAKM,WAAL,GAAmBN,EAAE,QAAF,CAAnB;AACA,OAAKO,WAAL,GAAmB,EAAnB;AACA,OAAKC,QAAL,GAAgB,IAAIC,iBAAJ,EAAhB;AACA,OAAKC,iBAAL,GAAyB,IAAIC,OAAJ,CAAY,IAAIC,gBAAJ,EAAZ,EAAoC,IAAIC,cAAJ,CAAmBb,EAAE,cAAF,CAAnB,CAApC,EAA2E,WAA3E,EAAwF,UAAxF,EAAoG,SAApG,EAA+G,UAA/G,EAA2H,QAA3H,CAAzB;AACA,OAAKc,SAAL,GAAiB,IAAIH,OAAJ,CAAY,IAAII,QAAJ,EAAZ,EAA4B,IAAIC,YAAJ,CAAiBhB,EAAE,WAAF,CAAjB,CAA5B,EAA8D,OAA9D,CAAjB;AACA,OAAKiB,KAAL;AACA;;;;0BAEO;AAAA;;AACPC,eAAY,YAAM;AACjB,UAAKC,wBAAL;AACA,IAFD,EAEG,IAFH;AAGA;;;4BAESC,K,EAAO;AAAA;;AAChBA,SAAMC,cAAN;AACA,OAAIC,aAAa,KAAKC,gBAAL,EAAjB;AACA,QAAKf,QAAL,CAAcgB,SAAd,CAAwBF,UAAxB,EAAoCG,IAApC,CAAyC,oBAAY;AACpD,WAAKf,iBAAL,CAAuBc,SAAvB,CAAiCF,UAAjC;AACA,WAAKR,SAAL,CAAeY,KAAf,GAAuB,oCAAvB;AACA,WAAKC,iBAAL;AACA,IAJD,EAIGC,KAJH,CAIS;AAAA,WAAS,OAAKd,SAAL,CAAeY,KAAf,GAAuBG,KAAhC;AAAA,IAJT;AAKA;;;kCAEe;AAAA;;AACf,QAAKrB,QAAL,CAAcsB,MAAd,GACEL,IADF,CACO,uBAAe;AACpBM,gBAAYC,OAAZ,CAAoB;AAAA,YAAc,OAAKtB,iBAAL,CAAuBc,SAAvB,CAAiCF,UAAjC,CAAd;AAAA,KAApB;AACA,IAHF,EAGIM,KAHJ,CAGU;AAAA,WAAS,OAAKd,SAAL,CAAeY,KAAf,GAAuBG,KAAhC;AAAA,IAHV;AAIA;;;iCAEc;AAAA;;AACd,QAAKrB,QAAL,CAAcyB,YAAd,GACER,IADF,CACO,YAAM;AACX,WAAKf,iBAAL,CAAuBwB,QAAvB;AACA,WAAKpB,SAAL,CAAeY,KAAf,GAAuB,kCAAvB;AACA,IAJF,EAIIE,KAJJ,CAIU;AAAA,WAAS,OAAKd,SAAL,CAAeY,KAAf,GAAuBG,KAAhC;AAAA,IAJV;AAKA;;;qCAEkB;AAClB,OAAIM,OAAOC,WAAWC,aAAX,CAAyB,KAAKjC,UAAL,CAAgBkC,KAAzC,CAAX;AACA,UAAO,IAAIC,UAAJ,CAAeJ,IAAf,EAAqB,KAAK9B,gBAAL,CAAsBiC,KAA3C,EAAkD,KAAKhC,WAAL,CAAiBgC,KAAnE,CAAP;AACA;;;sCAEmB;AACnB,QAAKlC,UAAL,CAAgBkC,KAAhB,GAAwB,EAAxB;AACA,QAAKjC,gBAAL,CAAsBiC,KAAtB,GAA8B,CAA9B;AACA,QAAKhC,WAAL,CAAiBgC,KAAjB,GAAyB,CAAzB;AACA,QAAKlC,UAAL,CAAgBoC,KAAhB;AACA;;;gCAEa;AACb,QAAK9B,iBAAL,CAAuBwB,QAAvB;AACA,QAAKpB,SAAL,CAAeY,KAAf,GAAuB,mCAAvB;AACA;;;6CAE0B;AAAA;;AAC1B,QAAKlB,QAAL,CAAciC,QAAd,CAAuB,KAAK/B,iBAA5B,EACCe,IADD,CACM;AAAA,WACLM,YAAYC,OAAZ,CAAoB,sBAAc;AACjC,YAAKtB,iBAAL,CAAuBc,SAAvB,CAAiCF,UAAjC;AACA,YAAKR,SAAL,CAAeY,KAAf,GAAuB,qCAAvB;AACA,KAHD,CADK;AAAA,IADN,EAOCE,KAPD,CAOO;AAAA,WAAS,OAAKd,SAAL,CAAeY,KAAf,GAAuBG,KAAhC;AAAA,IAPP;AAQA;;;wCAEqB;AAAA;;AACrB,QAAKrB,QAAL,CAAckC,wBAAd,GACEjB,IADF,CACO,uBAAe;AACpBM,gBAAYC,OAAZ,CAAoB;AAAA,YAAc,OAAKtB,iBAAL,CAAuBc,SAAvB,CAAiCF,UAAjC,CAAd;AAAA,KAApB;AACA,WAAKR,SAAL,CAAeY,KAAf,GAAuB,qCAAvB;AACA,IAJF,EAKEE,KALF,CAKQ;AAAA,WAAS,OAAKd,SAAL,CAAeY,KAAf,GAAuBG,KAAhC;AAAA,IALR;AAOA;;;kDAE+B;AAAA;;AAC/B,QAAKrB,QAAL,CAAcmC,wBAAd,GACElB,IADF,CACO,uBAAe;AACpBM,gBAAYC,OAAZ,CAAoB;AAAA,YAAc,OAAKtB,iBAAL,CAAuBc,SAAvB,CAAiCF,UAAjC,CAAd;AAAA,KAApB;AACA,WAAKR,SAAL,CAAeY,KAAf,GAAuB,gDAAvB;AACA,IAJF,EAKEE,KALF,CAKQ;AAAA,WAAQ,OAAKd,SAAL,CAAeY,KAAf,GAAuBkB,IAA/B;AAAA,IALR;AAMA;;;kDAE+B;AAAA;;AAC/B,QAAKpC,QAAL,CAAcqC,yBAAd,GACEpB,IADF,CACO,uBAAe;AACpBM,gBAAYC,OAAZ,CAAoB;AAAA,YAAc,OAAKtB,iBAAL,CAAuBc,SAAvB,CAAiCF,UAAjC,CAAd;AAAA,KAApB;AACA,WAAKR,SAAL,CAAeY,KAAf,GAAuB,gDAAvB;AACA,IAJF,EAKEE,KALF,CAKQ;AAAA,WAAQ,OAAKd,SAAL,CAAeY,KAAf,GAAuBkB,IAA/B;AAAA,IALR;AAMA;;;0BAEOE,M,EAAQ;AACf,OAAG,KAAKvC,WAAL,IAAoBuC,MAAvB,EAA+B;AAC9B,SAAKpC,iBAAL,CAAuBqC,QAAvB;AACA,IAFD,MAEO;AACN,SAAKrC,iBAAL,CAAuBsC,OAAvB,CAA+B,UAACC,CAAD,EAAIC,CAAJ;AAAA,YAAUD,EAAEH,MAAF,IAAYI,EAAEJ,MAAF,CAAtB;AAAA,KAA/B;AACA;AACD,QAAKvC,WAAL,GAAmBuC,MAAnB;AACA","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\r\n\r\n\tconstructor() {\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\t\tthis._campoData = $('#data');\r\n\t\tthis._campoQuantidade = $('#quantidade');\r\n\t\tthis._campoValor = $('#valor');\r\n\t\tthis._ordemAtual = '';\r\n\t\tthis._service = new NegociacaoService();\r\n\t\tthis._listaNegociacoes = new Binding(new ListaNegociacoes(), new NegociacaoView($(\"#negociacoes\")), 'adicionar', 'esvaziar', 'ordenar', 'inverter', 'listar');\t\t\r\n\t\tthis._mensagem = new Binding(new Mensagem(), new MensagemView($(\"#mensagem\")), 'texto');\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_init() {\r\n\t\tsetInterval(() => { \r\n\t\t\tthis.importarTodasNegociacoes();\r\n\t\t}, 3000);\r\n\t}\r\n\r\n\tadicionar(event) {\r\n\t\tevent.preventDefault();\r\n\t\tlet negociacao = this._criarNegociacao();\r\n\t\tthis._service.adicionar(negociacao).then(mensagem => {\r\n\t\t\tthis._listaNegociacoes.adicionar(negociacao);\r\n\t\t\tthis._mensagem.texto = \"Negociação adicionada com sucesso.\";\t\r\n\t\t\tthis._limparFormulario();\r\n\t\t}).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\tlistarTodosDb() {\r\n\t\tthis._service.listar()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t}).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\tremoverTodos() {\r\n\t\tthis._service.removerTodos()\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis._listaNegociacoes.esvaziar();\r\n\t\t\t\tthis._mensagem.texto = 'Negociações apagadas com sucesso';\r\n\t\t\t}).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\t_criarNegociacao() {\r\n\t\tlet data = DateHelper.textoParaData(this._campoData.value);\r\n\t\treturn new Negociacao(data, this._campoQuantidade.value, this._campoValor.value)\r\n\t}\r\n\r\n\t_limparFormulario() {\r\n\t\tthis._campoData.value = \"\";\r\n\t\tthis._campoQuantidade.value = 1;\r\n\t\tthis._campoValor.value = 0;\r\n\t\tthis._campoData.focus();\r\n\t}\r\n\r\n\tapagarLista() {\r\n\t\tthis._listaNegociacoes.esvaziar();\r\n\t\tthis._mensagem.texto = \"Negociações apagadas com sucesso.\";\r\n\t}\r\n\r\n\timportarTodasNegociacoes() {\r\n\t\tthis._service.importar(this._listaNegociacoes)\r\n\t\t.then(negociacoes => \r\n\t\t\tnegociacoes.forEach(negociacao => {\r\n\t\t\t\tthis._listaNegociacoes.adicionar(negociacao)\r\n\t\t\t\tthis._mensagem.texto = \"Negociações importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t)\r\n\t\t.catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\timportarNegociacoes() {\r\n\t\tthis._service.obterNegociacoesDaSemana()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t\tthis._mensagem.texto = \"Negociações importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t\t.catch(error => this._mensagem.texto = error);\r\n\t\t\r\n\t}\r\n\r\n\timportarNegociacoesAnteriores() {\r\n\t\tthis._service.obterNegociacoesAnterior()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t\tthis._mensagem.texto = \"Negociações anteriores importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\r\n\timportarNegociacoesRetrasadas() {\r\n\t\tthis._service.obterNegociacoesRetrasada()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t\tthis._mensagem.texto = \"Negociações retrasadas importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\r\n\tordenar(coluna) {\r\n\t\tif(this._ordemAtual == coluna) {\r\n\t\t\tthis._listaNegociacoes.inverter();\r\n\t\t} else {\r\n\t\t\tthis._listaNegociacoes.ordenar((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\t\tthis._ordemAtual = coluna;\r\n\t}\r\n\r\n}"]}