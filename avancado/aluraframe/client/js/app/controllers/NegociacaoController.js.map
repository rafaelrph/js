{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoService","ListaNegociacoes","Binding","DateHelper","Negociacao","Mensagem","MensagemView","NegociacaoView","NegociacaoController","$","document","querySelector","bind","_campoData","_campoQuantidade","_campoValor","_ordemAtual","_service","_listaNegociacoes","_mensagem","_init","setInterval","importarTodasNegociacoes","event","preventDefault","negociacao","_criarNegociacao","adicionar","then","texto","_limparFormulario","catch","error","listar","negociacoes","forEach","removerTodos","esvaziar","data","textoParaData","value","focus","importar","obterNegociacoesDaSemana","obterNegociacoesAnterior","erro","obterNegociacoesRetrasada","coluna","inverter","ordenar","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import {NegociacaoService} from '../services/NegociacaoService';\r\nimport {ListaNegociacoes} from '../models/ListaNegociacoes';\r\nimport {Binding} from '../helpers/Binding';\r\nimport {DateHelper} from '../helpers/DateHelper';\r\nimport {Negociacao} from '../models/Negociacao';\r\nimport {Mensagem} from '../models/Mensagem';\r\nimport {MensagemView} from '../views/MensagemView';\r\nimport {NegociacaoView} from '../views/NegociacaoView';\r\n\r\nexport class NegociacaoController {\r\n\r\n\tconstructor() {\r\n\t\tlet $ = document.querySelector.bind(document);\r\n\t\tthis._campoData = $('#data');\r\n\t\tthis._campoQuantidade = $('#quantidade');\r\n\t\tthis._campoValor = $('#valor');\r\n\t\tthis._ordemAtual = '';\r\n\t\tthis._service = new NegociacaoService();\r\n\t\tthis._listaNegociacoes = new Binding(new ListaNegociacoes(), new NegociacaoView($(\"#negociacoes\")), 'adicionar', 'esvaziar', 'ordenar', 'inverter', 'listar');\t\t\r\n\t\tthis._mensagem = new Binding(new Mensagem(), new MensagemView($(\"#mensagem\")), 'texto');\r\n\t\tthis._init();\r\n\t}\r\n\r\n\t_init() {\r\n\t\tsetInterval(() => { \r\n\t\t\tthis.importarTodasNegociacoes();\r\n\t\t}, 3000);\r\n\t}\r\n\r\n\tadicionar(event) {\r\n\t\tevent.preventDefault();\r\n\t\tlet negociacao = this._criarNegociacao();\r\n\t\tthis._service.adicionar(negociacao).then(mensagem => {\r\n\t\t\tthis._listaNegociacoes.adicionar(negociacao);\r\n\t\t\tthis._mensagem.texto = \"Negociação adicionada com sucesso.\";\t\r\n\t\t\tthis._limparFormulario();\r\n\t\t}).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\tlistarTodosDb() {\r\n\t\tthis._service.listar()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t}).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\tremoverTodos() {\r\n\t\tthis._service.removerTodos()\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis._listaNegociacoes.esvaziar();\r\n\t\t\t\tthis._mensagem.texto = 'Negociações apagadas com sucesso';\r\n\t\t\t}).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\t_criarNegociacao() {\r\n\t\tlet data = DateHelper.textoParaData(this._campoData.value);\r\n\t\treturn new Negociacao(data, this._campoQuantidade.value, this._campoValor.value)\r\n\t}\r\n\r\n\t_limparFormulario() {\r\n\t\tthis._campoData.value = \"\";\r\n\t\tthis._campoQuantidade.value = 1;\r\n\t\tthis._campoValor.value = 0;\r\n\t\tthis._campoData.focus();\r\n\t}\r\n\r\n\tapagarLista() {\r\n\t\tthis._listaNegociacoes.esvaziar();\r\n\t\tthis._mensagem.texto = \"Negociações apagadas com sucesso.\";\r\n\t}\r\n\r\n\timportarTodasNegociacoes() {\r\n\t\tthis._service.importar(this._listaNegociacoes)\r\n\t\t.then(negociacoes => \r\n\t\t\tnegociacoes.forEach(negociacao => {\r\n\t\t\t\tthis._listaNegociacoes.adicionar(negociacao)\r\n\t\t\t\tthis._mensagem.texto = \"Negociações importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t)\r\n\t\t.catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\timportarNegociacoes() {\r\n\t\tthis._service.obterNegociacoesDaSemana()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t\tthis._mensagem.texto = \"Negociações importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t\t.catch(error => this._mensagem.texto = error);\r\n\t\t\r\n\t}\r\n\r\n\timportarNegociacoesAnteriores() {\r\n\t\tthis._service.obterNegociacoesAnterior()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t\tthis._mensagem.texto = \"Negociações anteriores importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\r\n\timportarNegociacoesRetrasadas() {\r\n\t\tthis._service.obterNegociacoesRetrasada()\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\tnegociacoes.forEach(negociacao => this._listaNegociacoes.adicionar(negociacao));\r\n\t\t\t\tthis._mensagem.texto = \"Negociações retrasadas importadas com sucesso.\";\r\n\t\t\t})\r\n\t\t\t.catch(erro => this._mensagem.texto = erro);\r\n\t}\r\n\r\n\tordenar(coluna) {\r\n\t\tif(this._ordemAtual == coluna) {\r\n\t\t\tthis._listaNegociacoes.inverter();\r\n\t\t} else {\r\n\t\t\tthis._listaNegociacoes.ordenar((a, b) => a[coluna] - b[coluna]);\r\n\t\t}\r\n\t\tthis._ordemAtual = coluna;\r\n\t}\r\n\r\n}"]}