{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["NegociacaoService","_http","HttpService","negociacao","ConnectionFactory","getConnection","then","NegociacaoDao","connection","dao","adicionar","catch","Error","listar","removerTodos","listaAtual","obterTodasNegociacoes","negociacoes","filter","some","JSON","stringify","negociacaoExistente","_mensagem","texto","error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesAnterior","obterNegociacoesRetrasada","negociacoesPeriodo","reduce","arrayNegociacoes","array","concat","erro","get","map","Negociacao","Date","objeto","data","quantidade","valor"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["class NegociacaoService {\r\n\t\r\n\tconstructor() {\r\n\t\tthis._http = new HttpService();\r\n\t}\r\n\r\n\tadicionar(negociacao) {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.adicionar(negociacao))\r\n\t\t\t.then(() => 'Negociação cadastrada com sucesso')\r\n\t\t\t.catch(error => {\r\n\t\t\t\tthrow new Error('Não foi possível adicionar a negociação.');\r\n\t\t\t});\r\n\t}\r\n\r\n\tlistar() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.listar());\r\n\t}\r\n\r\n\tremoverTodos() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.removerTodos());\r\n\t}\r\n\r\n\timportar(listaAtual) {\r\n\t\treturn this.obterTodasNegociacoes()\r\n\t\t.then(negociacoes => \r\n\t\t\tnegociacoes.filter(negociacao => \r\n\t\t\t\t!listaAtual.negociacoes.some(negociacaoExistente => \r\n\t\t\t\t\tJSON.stringify(negociacao) == JSON.stringify(negociacaoExistente)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\tobterTodasNegociacoes() {\r\n\t\treturn Promise.all([\r\n\t\t\tthis.obterNegociacoesDaSemana(),\r\n\t\t\tthis.obterNegociacoesAnterior(),\r\n\t\t\tthis.obterNegociacoesRetrasada()\r\n\t\t])\r\n\t\t.then(negociacoesPeriodo => {\r\n\t\t\tlet negociacoes = negociacoesPeriodo.reduce((arrayNegociacoes, array) => arrayNegociacoes.concat(array), []);\r\n\t\t\treturn negociacoes;\r\n\t\t})\r\n\t\t.catch(erro => {\r\n\t\t\tthrow new Error(erro);\r\n\t\t});\r\n\t}\r\n\r\n    obterNegociacoesDaSemana() {\r\n\t\treturn this._http.get('negociacoes/semana')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor))\r\n\t\t\t}) \r\n\t\t\t.catch(erro => {\r\n\t\t\t\tthrow new Error(\"Não foi possível buscar os registros da semana.\")\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tobterNegociacoesAnterior() {\r\n\t\treturn this._http.get('negociacoes/anterior')\r\n\t\t.then(negociacoes => {\r\n\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor))\r\n\t\t}) \r\n\t\t.catch(erro => {\r\n\t\t\tthrow new Error(\"Não foi possível buscar os registros da semana anterior.\")\r\n\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesRetrasada() {\r\n\t\treturn this._http.get('negociacoes/retrasada')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor))\r\n\t\t\t}) \r\n\t\t\t.catch(erro => {\r\n\t\t\t\tthrow new Error(\"Não foi possível buscar os registros da retrasada.\")\r\n\t\t\t});\r\n\t}\r\n\r\n}"]}