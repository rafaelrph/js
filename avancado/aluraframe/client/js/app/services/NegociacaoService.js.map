{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["HttpService","ConnectionFactory","NegociacaoDao","Negociacao","NegociacaoService","_http","negociacao","getConnection","then","connection","dao","adicionar","catch","Error","listar","removerTodos","listaAtual","obterTodasNegociacoes","negociacoes","filter","some","JSON","stringify","negociacaoExistente","_mensagem","texto","error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesAnterior","obterNegociacoesRetrasada","negociacoesPeriodo","reduce","arrayNegociacoes","array","concat","erro","get","map","Date","objeto","data","quantidade","valor"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["import {HttpService} from './HttpService';\r\nimport {ConnectionFactory} from './ConnectionFactory';\r\nimport {NegociacaoDao} from '../dao/NegociacaoDao';\r\nimport {Negociacao} from '../models/Negociacao';\r\n\r\nexport class NegociacaoService {\r\n\t\r\n\tconstructor() {\r\n\t\tthis._http = new HttpService();\r\n\t}\r\n\r\n\tadicionar(negociacao) {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.adicionar(negociacao))\r\n\t\t\t.then(() => 'Negociação cadastrada com sucesso')\r\n\t\t\t.catch(error => {\r\n\t\t\t\tthrow new Error('Não foi possível adicionar a negociação.');\r\n\t\t\t});\r\n\t}\r\n\r\n\tlistar() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.listar());\r\n\t}\r\n\r\n\tremoverTodos() {\r\n\t\treturn ConnectionFactory.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.removerTodos());\r\n\t}\r\n\r\n\timportar(listaAtual) {\r\n\t\treturn this.obterTodasNegociacoes()\r\n\t\t.then(negociacoes => \r\n\t\t\tnegociacoes.filter(negociacao => \r\n\t\t\t\t!listaAtual.negociacoes.some(negociacaoExistente => \r\n\t\t\t\t\tJSON.stringify(negociacao) == JSON.stringify(negociacaoExistente)\r\n\t\t\t\t)\r\n\t\t\t)\r\n\t\t).catch(error => this._mensagem.texto = error);\r\n\t}\r\n\r\n\tobterTodasNegociacoes() {\r\n\t\treturn Promise.all([\r\n\t\t\tthis.obterNegociacoesDaSemana(),\r\n\t\t\tthis.obterNegociacoesAnterior(),\r\n\t\t\tthis.obterNegociacoesRetrasada()\r\n\t\t])\r\n\t\t.then(negociacoesPeriodo => {\r\n\t\t\tlet negociacoes = negociacoesPeriodo.reduce((arrayNegociacoes, array) => arrayNegociacoes.concat(array), []);\r\n\t\t\treturn negociacoes;\r\n\t\t})\r\n\t\t.catch(erro => {\r\n\t\t\tthrow new Error(erro);\r\n\t\t});\r\n\t}\r\n\r\n    obterNegociacoesDaSemana() {\r\n\t\treturn this._http.get('negociacoes/semana')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor))\r\n\t\t\t}) \r\n\t\t\t.catch(erro => {\r\n\t\t\t\tthrow new Error(\"Não foi possível buscar os registros da semana.\")\r\n\t\t\t});\r\n\t}\r\n\t\r\n\tobterNegociacoesAnterior() {\r\n\t\treturn this._http.get('negociacoes/anterior')\r\n\t\t.then(negociacoes => {\r\n\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor))\r\n\t\t}) \r\n\t\t.catch(erro => {\r\n\t\t\tthrow new Error(\"Não foi possível buscar os registros da semana anterior.\")\r\n\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesRetrasada() {\r\n\t\treturn this._http.get('negociacoes/retrasada')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor))\r\n\t\t\t}) \r\n\t\t\t.catch(erro => {\r\n\t\t\t\tthrow new Error(\"Não foi possível buscar os registros da retrasada.\")\r\n\t\t\t});\r\n\t}\r\n\r\n}"]}